FROM python:3.11-slim

WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \
    gcc \
    git \
    curl \
    wget \
    && rm -rf /var/lib/apt/lists/*

# Install Python dependencies
RUN pip install --no-cache-dir \
    pandas==2.1.3 \
    numpy==1.26.2 \
    scikit-learn==1.3.2 \
    xgboost==2.0.2 \
    lightgbm==4.1.0 \
    anthropic==0.46.0 \
    requests==2.31.0 \
    beautifulsoup4==4.12.2 \
    lxml==4.9.3 \
    kaggle==1.5.16

# Copy agent code
COPY agent/ ./agent/

# Create output directory
RUN mkdir -p /output

# Set Python path so imports work
ENV PYTHONPATH=/app

# Set entrypoint
ENTRYPOINT ["python", "/app/agent/main.py"]

